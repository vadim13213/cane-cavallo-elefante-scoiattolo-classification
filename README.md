# üêîüêÑüêëüêé –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∂–∏–≤–æ—Ç–Ω—ã—Ö –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º

## üìù –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∏—Å—Ç–µ–º—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –ø–æ–∑–≤–æ–ª—è—é—â–µ–π –æ—Ç–ª–∏—á–∞—Ç—å **–∫—É—Ä–∏—Ü—É**, **–∫–æ—Ä–æ–≤—É**, **–æ–≤—Ü—É** –∏ **–ª–æ—à–∞–¥—å**. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –ø–æ–º–æ—â—å—é **Streamlit**, —Å–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å ‚Äî –Ω–∞ **FastAPI**. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ —Ä–∏—Å–æ–≤–∞—Ç—å –µ–≥–æ –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –ø–æ—Å–ª–µ —á–µ–≥–æ –æ–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞.

–í –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –Ω–∞–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö ([–ò—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ Kaggle](https://www.kaggle.com/datasets/alessiocorrado99/animals10)). –í –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è 10 –∫–ª–∞—Å—Å–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∂–∏–≤–æ—Ç–Ω—ã—Ö —Å —Ä–∞–∑–Ω—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –∏ —Ä–∞–∑–Ω—ã–º –∫–æ–ª–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –∫–ª–∞—Å—Å. –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∏ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ä–∞–≤–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–ª–∞—Å—Å –¥–∞—Ç–∞—Å–µ—Ç –±—ã–ª –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω –∫ –Ω—É–∂–Ω–æ–º—É –≤–∏–¥—É (–≤—ã–±—Ä–∞–Ω–æ 4 –∫–ª–∞—Å—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏, —É—Ä–∞–≤–Ω–æ–≤–µ—à–µ–Ω–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö ‚Äî 1800 –Ω–∞ –∫–ª–∞—Å—Å).

### üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Ä–∏—Å–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –≤—Å–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è.

---

## üì¶ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python üêç
- TensorFlow / Keras ü§ñ
- FastAPI ‚ö°
- Streamlit üåê
- OpenCV üì∑
- NumPy üìä
- Pillow üñºÔ∏è

---

## üîç –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏

| –ò–º—è –º–æ–¥–µ–ª–∏               | –¢–æ—á–Ω–æ—Å—Ç—å | –ü–æ–ª–Ω–æ—Ç–∞ |      Precision      | F1-–º–µ—Ä–∞|
|--------------------------|----------|---------|---------------------|--------|
| **deep_cnn(work_‚Ññ3)**    |  0.9181  | 0.9181  | 0.9182              | 0.9180 |
| **residual_cnn(work_‚Ññ4)**|  0.8854  | 0.8854  | 0.8860              | 0.8852 |
| **simple_cnn(work_‚Ññ3)**  |  0.8729  | 0.8729  | 0.8743              | 0.8728 |
| **simple_dnn(work_‚Ññ2)**  |  0.5458  | 0.5458  | 0.5409              | 0.5378 |

**–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –ø–æ F1-–º–µ—Ä–µ: deep_cnn(work_‚Ññ3) aka best_model_resnet_like.keras**

<p align="center"> <img src="https://i.imgur.com/VvGk8E3.png" alt="confusion_matrix" width="1000"/> </p>

[–°—Å—ã–ª–∫–∞ –Ω–∞ –±–ª–æ–∫–Ω–æ—Ç —Å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π](https://github.com/Poziloi/neural_networks/blob/main/%D0%9F%D1%80%D0%B0%D0%BA%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0_%E2%84%969_%D0%A1%D1%80%D0%B0%D0%B2%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B5%D0%B9_%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8_%D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9_%D0%B8_%D1%80%D0%B0%D0%B7%D0%B2%D0%B5%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_API_%D0%A1%D0%BC%D1%8B%D1%81%D0%BB%D0%BE%D0%B2_%D0%90%D0%BB%D0%B5%D0%BA%D1%81%D0%B5%D0%B9.ipynb)

---

## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ **Streamlit**:

<p align="center"> <img src="https://i.imgur.com/fkbFT5t.png" alt="confusion_matrix" width="600"/> </p>

---

## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

```bash
git clone https://github.com/Poziloi/chicken_cow_horse_sheep-classification.git
cd chicken_cow_horse_sheep-classification
```

2. **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –µ–≥–æ:**

```bash
python -m venv .venv
source .venv/bin/activate     # Linux/macOS
.venv\Scripts\activate      # Windows
```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```bash
pip install -r requirements.txt
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ FastAPI-—Å–µ—Ä–≤–µ—Ä:**

```bash
uvicorn main:app --host 0.0.0.0 --port 8000
```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Streamlit-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

```bash
streamlit run app.py
```

6. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
[http://localhost:8501](http://localhost:8501)
(–ø–æ—Ä—Ç 8501 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

---

## üîó –†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

- üéØ **Streamlit-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: [https://chicken-cow-horse-sheep-classification.streamlit.app/](https://chicken-cow-horse-sheep-classification.streamlit.app/)
- ‚ö° **API —Å–µ—Ä–≤–µ—Ä (FastAPI)**: [https://chicken-cow-horse-sheep-classification.onrender.com/docs](https://chicken-cow-horse-sheep-classification.onrender.com/docs)

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

### –ü—Ä–∏–º–µ—Ä POST-–∑–∞–ø—Ä–æ—Å–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º

```bash
curl -X POST "https://chicken-api.onrender.com/predict/" \
  -H "accept: application/json" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@example.jpg"
```

### –û—Ç–≤–µ—Ç:

```json
{
  "predicted_class": "3",
  "probabilities": {
    "0": 1.52e-8,
    "1": 0.207,
    "2": 0.000045,
    "3": 0.793
  }
}
```

**–ì–¥–µ:**
- `"0"` ‚Äî –∫—É—Ä–∏—Ü–∞ üêî  
- `"1"` ‚Äî –∫–æ—Ä–æ–≤–∞ üêÑ  
- `"2"` ‚Äî –æ–≤—Ü–∞ üêë  
- `"3"` ‚Äî –ª–æ—à–∞–¥—å üêé  

---
